---
// Import Swiper styles
import "swiper/css";
import "swiper/css/navigation";
import "swiper/css/pagination";

const images = [
    { src: "/pres01.webp", alt: "Juan performing at a local festival" },
    { src: "/pres02.webp", alt: "Juan on stage with his violin" },
    { src: "/pres03.webp", alt: "Juan playing in a traditional costume" },
    { src: "/pres01.webp", alt: "Juan at a music competition" },
    { src: "/pres02.webp", alt: "Juan performing with other musicians" },
    { src: "/pres03.webp", alt: "Juan performing with other musicians" },
];
---

<section id="gallery" class="image-carousel">
    <div class="container">
        <h2>Performance Gallery</h2>
        <div class="swiper">
            <div class="swiper-wrapper">
                {
                    images.map((image, index) => (
                        <div class="swiper-slide">
                            <img
                                src={image.src}
                                alt={image.alt}
                                onclick={`openModal('${image.src}', '${image.alt}')`}
                            />
                        </div>
                    ))
                }
            </div>
            <div class="swiper-pagination"></div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
        </div>
    </div>
</section>

<div id="imageModal" class="modal">
    <span class="close" onclick="closeModal()">&times;</span>
    <img class="modal-content" id="modalImage" />
    <div id="modalCaption"></div>
</div>

<script>
    import Swiper from "swiper";
    import { Navigation, Pagination, Autoplay } from "swiper/modules";

    new Swiper(".image-carousel .swiper", {
        modules: [Navigation, Pagination, Autoplay],
        spaceBetween: 30,
        slidesPerView: 1,
        navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
        },
        pagination: {
            el: ".swiper-pagination",
            clickable: true,
        },
        autoplay: {
            delay: 5000,
            disableOnInteraction: false,
        },
        breakpoints: {
            640: {
                slidesPerView: 2,
            },
            1024: {
                slidesPerView: 3,
            },
        },
    });

    // Modal functionality
    function openModal(src: string, alt: string) {
        const modal = document.getElementById("imageModal");
        const modalImg = document.getElementById("modalImage") as HTMLImageElement;
        const captionText = document.getElementById("modalCaption");
        if (modal && modalImg && captionText) {
            modal.style.display = "block";
            modalImg.src = src;
            captionText.innerHTML = alt;
        }
    }

    function closeModal() {
        const modal = document.getElementById("imageModal");
        if (modal) {
            modal.style.display = "none";
        }
    }

    // Close modal when clicking outside the image
    window.onclick = function (event: MouseEvent) {
        const modal = document.getElementById("imageModal");
        if (event.target == modal) {
            closeModal();
        }
    };

    // Attach functions to window object
    (window as any).openModal = openModal;
    (window as any).closeModal = closeModal;
</script>

<style>
    .image-carousel {
        background-color: rgb(var(--background));
        padding: 6rem 0;
    }
    h2 {
        text-align: center;
        color: rgb(var(--accent));
        font-size: 3rem;
        margin-bottom: 3rem;
    }
    .swiper {
        padding-bottom: 50px;
    }
    .swiper-slide img {
        width: 100%;
        height: 300px;
        object-fit: cover;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease;
        cursor: pointer;
    }
    .swiper-slide img:hover {
        transform: scale(1.05);
    }
    :global(.image-carousel .swiper-button-next),
    :global(.image-carousel .swiper-button-prev) {
        color: rgb(var(--accent));
    }
    :global(.image-carousel .swiper-pagination-bullet-active) {
        background-color: rgb(var(--accent));
    }

    /* Modal styles */
    .modal {
        display: none;
        position: fixed;
        z-index: 1001;
        padding-top: 100px;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.9);
    }
    .modal-content {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 700px;
    }
    #modalCaption {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 700px;
        text-align: center;
        color: #ccc;
        padding: 10px 0;
        height: 150px;
    }
    .modal-content,
    #modalCaption {
        animation-name: zoom;
        animation-duration: 0.6s;
    }
    @keyframes zoom {
        from {
            transform: scale(0);
        }
        to {
            transform: scale(1);
        }
    }
    .close {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        transition: 0.3s;
    }
    .close:hover,
    .close:focus {
        color: #bbb;
        text-decoration: none;
        cursor: pointer;
    }
    @media only screen and (max-width: 700px) {
        .modal-content {
            width: 100%;
        }
    }
</style>
